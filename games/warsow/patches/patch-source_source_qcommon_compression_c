$OpenBSD$

Index: source/source/qcommon/compression.c
--- source/source/qcommon/compression.c.orig
+++ source/source/qcommon/compression.c
@@ -23,59 +23,11 @@ Foundation, Inc., 59 Temple Place - Suite 330, Boston,
 
 static void *zLibrary;
 
-#ifdef ZLIB_RUNTIME
-
-int (ZEXPORT *qzcompress)(Bytef *dest,uLongf *destLen, const Bytef *source, uLong sourceLen);
-int (ZEXPORT *qzcompress2)(Bytef *dest, uLongf *destLen, const Bytef *source, uLong sourceLen, int level);
-int (ZEXPORT *qzuncompress)(Bytef *dest, uLongf *destLen, const Bytef *source, uLong sourceLen);
-int (ZEXPORT *qzinflateInit2_)(z_streamp strm, int  windowBits, const char *version, int stream_size);
-int (ZEXPORT *qzinflate)(z_streamp strm, int flush);
-int (ZEXPORT *qzinflateEnd)(z_streamp strm);
-int (ZEXPORT *qzinflateReset)(z_streamp strm);
-gzFile (ZEXPORT *qgzopen)(const char *, const char *);
-z_off_t (ZEXPORT *qgzseek)(gzFile, z_off_t, int);
-z_off_t (ZEXPORT *qgztell)(gzFile);
-int (ZEXPORT *qgzread)(gzFile file, voidp buf, unsigned len);
-int (ZEXPORT *qgzwrite)(gzFile file, voidpc buf, unsigned len);
-int (ZEXPORT *qgzclose)(gzFile file);
-int (ZEXPORT *qgzeof)(gzFile file);
-int (ZEXPORT *qgzflush)(gzFile file, int flush);
-int (ZEXPORT *qgzsetparams)(gzFile file, int level, int strategy);
-int (ZEXPORT *qgzbuffer)(gzFile file, unsigned size);
-
-static dllfunc_t zlibfuncs[] =
-{
-	{ "compress", ( void **)&qzcompress },
-	{ "compress2", ( void **)&qzcompress2 },
-	{ "uncompress", ( void **)&qzuncompress },
-	{ "inflateInit2_", ( void **)&qzinflateInit2_ },
-	{ "inflate", ( void **)&qzinflate },
-	{ "inflateEnd", ( void **)&qzinflateEnd },
-	{ "inflateReset", ( void **)&qzinflateReset },
-	{ "gzopen", ( void **)&qgzopen },
-	{ "gzseek", ( void **)&qgzseek },
-	{ "gztell", ( void **)&qgztell },
-	{ "gzread", ( void **)&qgzread },
-	{ "gzwrite", ( void **)&qgzwrite },
-	{ "gzclose", ( void **)&qgzclose },
-	{ "gzeof", ( void **)&qgzeof },
-	{ "gzflush", ( void **)&qgzflush },
-	{ "gzsetparams", ( void **)&qgzsetparams },
-	{ "gzbuffer", ( void **)&qgzbuffer },
-	{ NULL, NULL },
-};
-
-#endif
-
 /*
 * ZLib_UnloadLibrary
 */
 void ZLib_UnloadLibrary( void )
 {
-#ifdef ZLIB_RUNTIME
-	if( zLibrary )
-		Com_UnloadLibrary( &zLibrary );
-#endif
 	zLibrary = NULL;
 }
 
@@ -86,13 +38,7 @@ void ZLib_LoadLibrary( void )
 {
 	ZLib_UnloadLibrary();
 
-#ifdef ZLIB_RUNTIME
-	zLibrary = Com_LoadSysLibrary( LIBZ_LIBNAME, zlibfuncs );
-	if( !zLibrary )
-		Com_Error( ERR_FATAL, "Failed to load %s", LIBZ_LIBNAME );
-#else
 	zLibrary = (void *)1;
-#endif
 }
 
 /*
