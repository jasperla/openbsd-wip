$OpenBSD$

Index: source/source/snd_qf/snd_ogg.c
--- source/source/snd_qf/snd_ogg.c.orig
+++ source/source/snd_qf/snd_ogg.c
@@ -24,40 +24,6 @@ Foundation, Inc., 59 Temple Place - Suite 330, Boston,
 #include "snd_local.h"
 #include <vorbis/vorbisfile.h>
 
-#ifdef VORBISLIB_RUNTIME
-
-void *vorbisLibrary = NULL;
-
-int ( *qov_clear )( OggVorbis_File *vf );
-int ( *qov_open_callbacks )( void *datasource, OggVorbis_File *vf, const char *initial, long ibytes, ov_callbacks callbacks );
-ogg_int64_t ( *qov_pcm_total )( OggVorbis_File *vf, int i );
-int ( *qov_pcm_seek )( OggVorbis_File *vf, ogg_int64_t pos );
-int ( *qov_raw_seek )( OggVorbis_File *vf, ogg_int64_t pos );
-ogg_int64_t ( *qov_raw_tell )( OggVorbis_File *vf );
-vorbis_info *( *qov_info )( OggVorbis_File *vf, int link );
-long ( *qov_read )( OggVorbis_File *vf, char *buffer, int length, int bigendianp, int word, int sgned, int *bitstream );
-long ( *qov_streams )( OggVorbis_File *vf );
-long ( *qov_seekable )( OggVorbis_File *vf );
-int ( *qov_pcm_seek )( OggVorbis_File *vf, ogg_int64_t pos );
-
-dllfunc_t oggvorbisfuncs[] =
-{
-	{ "ov_clear", ( void ** )&qov_clear },
-	{ "ov_open_callbacks", ( void ** )&qov_open_callbacks },
-	{ "ov_pcm_total", ( void ** )&qov_pcm_total },
-	{ "ov_raw_seek", ( void ** )&qov_raw_seek },
-	{ "ov_raw_tell", ( void ** )&qov_raw_tell },
-	{ "ov_info", ( void ** )&qov_info },
-	{ "ov_read", ( void ** )&qov_read },
-	{ "ov_streams", ( void ** )&qov_streams },
-	{ "ov_seekable", ( void ** )&qov_seekable },
-	{ "ov_pcm_seek", ( void ** )&qov_pcm_seek },
-
-	{ NULL, NULL }
-};
-
-#else // VORBISLIB_RUNTIME
-
 #define qov_clear ov_clear
 #define qov_open_callbacks ov_open_callbacks
 #define qov_pcm_total ov_pcm_total
@@ -69,17 +35,11 @@ dllfunc_t oggvorbisfuncs[] =
 #define qov_seekable ov_seekable
 #define qov_pcm_seek ov_pcm_seek
 
-#endif // VORBISLIB_RUNTIME
-
 /*
 * SNDOGG_Shutdown
 */
 void SNDOGG_Shutdown( bool verbose )
 {
-#ifdef VORBISLIB_RUNTIME
-	if( vorbisLibrary )
-		trap_UnloadLibrary( &vorbisLibrary );
-#endif
 }
 
 /*
@@ -87,11 +47,6 @@ void SNDOGG_Shutdown( bool verbose )
 */
 void SNDOGG_Init( bool verbose )
 {
-#ifdef VORBISLIB_RUNTIME
-	if( vorbisLibrary )
-		SNDOGG_Shutdown( verbose );
-	vorbisLibrary = trap_LoadLibrary( LIBVORBISFILE_LIBNAME, oggvorbisfuncs );
-#endif
 }
 
 //=============================================================================
@@ -166,11 +121,6 @@ sfxcache_t *SNDOGG_Load( sfx_t *s )
 	assert( s && s->name[0] );
 	assert( !s->cache );
 
-#ifdef VORBISLIB_RUNTIME
-	if( !vorbisLibrary )
-		return NULL;
-#endif
-
 	trap_FS_FOpenFile( s->name, &filenum, FS_READ );
 	if( !filenum )
 		return NULL;
@@ -277,10 +227,6 @@ bool SNDOGG_OpenTrack( bgTrack_t *track, bool *delay )
 	OggVorbis_File *vf;
 	ov_callbacks callbacks = { ovcb_read, ovcb_seek, ovcb_close, ovcb_tell };
 
-#ifdef VORBISLIB_RUNTIME
-	if( !vorbisLibrary )
-		return false;
-#endif
 	if( delay )
 		*delay = false;
 	if( !track )
